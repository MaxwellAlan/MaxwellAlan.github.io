<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>AlanMaxwell</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="#Android No.3
标签（空格分隔）： Android

#1 Android下数据库创建 
什么情况下我们才用数据库做数据存储？ 大量数据结构相同的数据需要存储时。
mysql sqlserver2000  sqlite 嵌入式 轻量级
SqliteOpenHelper
创建数据库步骤：
1.创建一个类集成SqliteOpenHelper，需要添加一个构造方法，实现两个方法oncreat">
<meta property="og:type" content="article">
<meta property="og:title" content="AlanMaxwell">
<meta property="og:url" content="http://yoursite.com/2016/10/20/Android No.3/index.html">
<meta property="og:site_name" content="AlanMaxwell">
<meta property="og:description" content="#Android No.3
标签（空格分隔）： Android

#1 Android下数据库创建 
什么情况下我们才用数据库做数据存储？ 大量数据结构相同的数据需要存储时。
mysql sqlserver2000  sqlite 嵌入式 轻量级
SqliteOpenHelper
创建数据库步骤：
1.创建一个类集成SqliteOpenHelper，需要添加一个构造方法，实现两个方法oncreat">
<meta property="og:updated_time" content="2016-10-20T07:02:39.015Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="AlanMaxwell">
<meta name="twitter:description" content="#Android No.3
标签（空格分隔）： Android

#1 Android下数据库创建 
什么情况下我们才用数据库做数据存储？ 大量数据结构相同的数据需要存储时。
mysql sqlserver2000  sqlite 嵌入式 轻量级
SqliteOpenHelper
创建数据库步骤：
1.创建一个类集成SqliteOpenHelper，需要添加一个构造方法，实现两个方法oncreat">
  
    <link rel="alternate" href="/atom.xml" title="AlanMaxwell" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">AlanMaxwell</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Android No.3" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/10/20/Android No.3/" class="article-date">
  <time datetime="2016-10-20T07:02:34.262Z" itemprop="datePublished">2016-10-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>#Android No.3</p>
<p>标签（空格分隔）： Android</p>
<hr>
<p>#1 Android下数据库创建 </p>
<p>什么情况下我们才用数据库做数据存储？ 大量数据结构相同的数据需要存储时。</p>
<p>mysql sqlserver2000  sqlite 嵌入式 轻量级</p>
<p>SqliteOpenHelper</p>
<p>创建数据库步骤：</p>
<p>1.创建一个类集成SqliteOpenHelper，需要添加一个构造方法，实现两个方法oncreate ,onupgrade</p>
<pre><code>构造方法中的参数介绍：




//context :上下文   ， name：数据库文件的名称    factory：用来创建cursor对象，默认为null 

//version:数据库的版本号，从1开始，如果发生改变，onUpgrade方法将会调用,4.0之后只能升不能将

super(context, &quot;info.db&quot;, null,1);
</code></pre><p>2.创建这个帮助类的一个对象，调用getReadableDatabase()方法，会帮助我们创建打开一个数据库</p>
<p>3.复写oncreate和onupgrdate方法：</p>
<pre><code>oncreate方法是数据库第一次创建的时候会被调用;  特别适合做表结构的初始化,需要执行sql语句；SQLiteDatabase db可以用来执行sql语句



//onUpgrade数据库版本号发生改变时才会执行； 特别适合做表结构的修改
</code></pre><p>帮助类对象中的getWritableDatabase 和 getReadableDatabase都可以帮助我们获取一个数据库操作对象SqliteDatabase.</p>
<p>区别：</p>
<p>getReadableDatabase:</p>
<pre><code>先尝试以读写方式打开数据库，如果磁盘空间满了，他会重新尝试以只读方式打开数据库。
</code></pre><p>getWritableDatabase:</p>
<pre><code>直接以读写方式打开数据库，如果磁盘空间满了，就直接报错。
</code></pre><p>#2 Android下数据库第一种方式增删改查</p>
<p>1.创建一个帮助类的对象，调用getReadableDatabase方法，返回一个SqliteDatebase对象</p>
<p>2.使用SqliteDatebase对象调用execSql()做增删改,调用rawQuery方法做查询。</p>
<p><strong>**</strong>特点:增删改没有返回值，不能判断sql语句是否执行成功。sql语句手动写，容易写错</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">private MySqliteOpenHelper mySqliteOpenHelper;</div><div class="line">	</div><div class="line">public InfoDao(Context context)&#123;</div><div class="line">	</div><div class="line">	//创建一个帮助类对象</div><div class="line">	</div><div class="line">	mySqliteOpenHelper = new MySqliteOpenHelper(context);</div><div class="line"></div><div class="line">	</div><div class="line"></div><div class="line"></div><div class="line">	</div><div class="line">	</div><div class="line">&#125;</div><div class="line"></div><div class="line">	</div><div class="line"></div><div class="line"></div><div class="line">public void add(InfoBean bean)&#123;</div><div class="line"></div><div class="line">	</div><div class="line"></div><div class="line"></div><div class="line">	//执行sql语句需要sqliteDatabase对象</div><div class="line">	</div><div class="line">	//调用getReadableDatabase方法,来初始化数据库的创建</div><div class="line">	</div><div class="line">	SQLiteDatabase 	db = mySqliteOpenHelper.getReadableDatabase();</div><div class="line">	</div><div class="line">	//sql:sql语句，  bindArgs：sql语句中占位符的值</div><div class="line">	</div><div class="line">	db.execSQL(&quot;insert into info(name,phone) values(?,?);&quot;, new Object[]&#123;bean.name,bean.phone&#125;);</div><div class="line">	</div><div class="line">	//关闭数据库对象</div><div class="line">	</div><div class="line">	db.close();</div><div class="line">	</div><div class="line">&#125;</div><div class="line"></div><div class="line">	</div><div class="line"></div><div class="line"></div><div class="line">public void del(String name)&#123;</div><div class="line"></div><div class="line"></div><div class="line">	</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">	//执行sql语句需要sqliteDatabase对象</div><div class="line">	</div><div class="line">	//调用getReadableDatabase方法,来初始化数据库的创建</div><div class="line">	</div><div class="line">	SQLiteDatabase db = mySqliteOpenHelper.getReadableDatabase();</div><div class="line">	</div><div class="line">	//sql:sql语句，  bindArgs：sql语句中占位符的值</div><div class="line">	</div><div class="line">	db.execSQL(&quot;delete from info where name=?;&quot;, new Object[]&#123;name&#125;);</div><div class="line">	</div><div class="line">	//关闭数据库对象</div><div class="line">	</div><div class="line">	db.close();</div><div class="line"></div><div class="line">	</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div><div class="line">	</div><div class="line">public void update(InfoBean bean)&#123;</div><div class="line"></div><div class="line">	</div><div class="line"></div><div class="line"></div><div class="line">	//执行sql语句需要sqliteDatabase对象</div><div class="line">	</div><div class="line">	//调用getReadableDatabase方法,来初始化数据库的创建</div><div class="line">	</div><div class="line">	SQLiteDatabase db = mySqliteOpenHelper.getReadableDatabase();</div><div class="line">	</div><div class="line">	//sql:sql语句，  bindArgs：sql语句中占位符的值</div><div class="line">	</div><div class="line">	db.execSQL(&quot;update info set phone=? where name=?;&quot;, new Object[]&#123;bean.phone,bean.name&#125;);</div><div class="line">	</div><div class="line">	//关闭数据库对象</div><div class="line">	</div><div class="line">	db.close();</div><div class="line"></div><div class="line">	</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div><div class="line">	</div><div class="line">public void query(String name)&#123;</div><div class="line">	</div><div class="line">	</div><div class="line">	</div><div class="line">	//执行sql语句需要sqliteDatabase对象</div><div class="line">	</div><div class="line">	//调用getReadableDatabase方法,来初始化数据库的创建</div><div class="line">	</div><div class="line">	SQLiteDatabase db = mySqliteOpenHelper.getReadableDatabase();</div><div class="line">	</div><div class="line">	//sql:sql语句，  selectionArgs:查询条件占位符的值,返回一个cursor对象</div><div class="line">	</div><div class="line">	Cursor cursor = db.rawQuery(&quot;select _id, name,phone from info where name = ?&quot;, new String []&#123;name&#125;);</div><div class="line">	</div><div class="line">	//解析Cursor中的数据</div><div class="line">	</div><div class="line">	if(cursor != null &amp;&amp; cursor.getCount() &gt;0)&#123;//判断cursor中是否存在数据</div><div class="line">	</div><div class="line">		</div><div class="line">	</div><div class="line">		//循环遍历结果集，获取每一行的内容</div><div class="line">	</div><div class="line">		while(cursor.moveToNext())&#123;//条件，游标能否定位到下一行</div><div class="line">	</div><div class="line">			//获取数据</div><div class="line">	</div><div class="line">			int id = cursor.getInt(0);</div><div class="line">	</div><div class="line">			String name_str = cursor.getString(1);</div><div class="line">	</div><div class="line">			String phone = cursor.getString(2);</div><div class="line">	</div><div class="line">			System.out.println(&quot;_id:&quot;+id+&quot;;name:&quot;+name_str+&quot;;phone:&quot;+phone);</div><div class="line">	</div><div class="line">		&#125;</div><div class="line">	</div><div class="line">		cursor.close();//关闭结果集</div><div class="line">	</div><div class="line">		</div><div class="line">	</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	//关闭数据库对象</div><div class="line">	</div><div class="line">	db.close();</div><div class="line"></div><div class="line">	</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>#3 Android下另外一种增删改查方式 </p>
<p>1.创建一个帮助类的对象，调用getReadableDatabase方法，返回一个SqliteDatebase对象</p>
<p>2.使用SqliteDatebase对象调用insert,update,delete ,query方法做增删改查。</p>
<p><strong>**</strong>特点:增删改有了返回值，可以判断sql语句是否执行成功，但是查询不够灵活，不能做多表查询。所以在公司一般人增删改喜欢用第二种方式，查询用第一种方式。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div></pre></td><td class="code"><pre><div class="line">		private MySqliteOpenHelper mySqliteOpenHelper;</div><div class="line">	</div><div class="line">public InfoDao(Context context)&#123;</div><div class="line">	</div><div class="line">	//创建一个帮助类对象</div><div class="line">	</div><div class="line">	mySqliteOpenHelper = new MySqliteOpenHelper(context);</div><div class="line">	</div><div class="line">&#125;</div><div class="line"></div><div class="line">public boolean add(InfoBean bean)&#123;</div><div class="line"></div><div class="line">	//执行sql语句需要sqliteDatabase对象</div><div class="line">	</div><div class="line">	//调用getReadableDatabase方法,来初始化数据库的创建</div><div class="line">	</div><div class="line">	SQLiteDatabase 	db = mySqliteOpenHelper.getReadableDatabase();</div><div class="line">	</div><div class="line">	ContentValues values = new ContentValues();//是用map封装的对象，用来存放值</div><div class="line">	</div><div class="line">	values.put(&quot;name&quot;, bean.name);</div><div class="line">	</div><div class="line">	values.put(&quot;phone&quot;, bean.phone);</div><div class="line">	</div><div class="line">	</div><div class="line">	</div><div class="line">	//table: 表名 , nullColumnHack：可以为空，标示添加一个空行, values:数据一行的值 , 返回值：代表添加这个新行的Id ，-1代表添加失败</div><div class="line">	</div><div class="line">	long result = db.insert(&quot;info&quot;, null, values);//底层是在拼装sql语句</div><div class="line">	</div><div class="line">	//关闭数据库对象</div><div class="line">	</div><div class="line">	db.close();</div><div class="line">	</div><div class="line">	</div><div class="line">	</div><div class="line">	if(result != -1)&#123;//-1代表添加失败</div><div class="line">	</div><div class="line">		return true;</div><div class="line">	</div><div class="line">	&#125;else&#123;</div><div class="line">	</div><div class="line">		return false;</div><div class="line">	</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">&#125;</div><div class="line"></div><div class="line">	</div><div class="line"></div><div class="line"></div><div class="line">public int del(String name)&#123;</div><div class="line"></div><div class="line">	</div><div class="line">	//执行sql语句需要sqliteDatabase对象</div><div class="line">	</div><div class="line">	//调用getReadableDatabase方法,来初始化数据库的创建</div><div class="line">	</div><div class="line">	SQLiteDatabase db = mySqliteOpenHelper.getReadableDatabase();</div><div class="line">	</div><div class="line">	</div><div class="line">	</div><div class="line">	//table ：表名, whereClause: 删除条件, whereArgs：条件的占位符的参数 ; 返回值：成功删除多少行</div><div class="line">	</div><div class="line">	int result = db.delete(&quot;info&quot;, &quot;name = ?&quot;, new String[]&#123;name&#125;);</div><div class="line">	</div><div class="line">	//关闭数据库对象</div><div class="line">	</div><div class="line">	db.close();</div><div class="line">	</div><div class="line">	return result;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div><div class="line">	</div><div class="line">public int update(InfoBean bean)&#123;</div><div class="line"></div><div class="line">	</div><div class="line"></div><div class="line"></div><div class="line">	//执行sql语句需要sqliteDatabase对象</div><div class="line">	</div><div class="line">	//调用getReadableDatabase方法,来初始化数据库的创建</div><div class="line">	</div><div class="line">	SQLiteDatabase db = mySqliteOpenHelper.getReadableDatabase();</div><div class="line">	</div><div class="line">	ContentValues values = new ContentValues();//是用map封装的对象，用来存放值</div><div class="line">	</div><div class="line">	values.put(&quot;phone&quot;, bean.phone);</div><div class="line">	</div><div class="line">	//table:表名, values：更新的值, whereClause:更新的条件, whereArgs：更新条件的占位符的值,返回值：成功修改多少行</div><div class="line">	</div><div class="line">	int result = db.update(&quot;info&quot;, values, &quot;name = ?&quot;, new String[]&#123;bean.name&#125;);</div><div class="line">	</div><div class="line">	//关闭数据库对象</div><div class="line">	</div><div class="line">	db.close();</div><div class="line">	</div><div class="line">	return result;</div><div class="line"></div><div class="line">&#125;</div><div class="line">	</div><div class="line">public void query(String name)&#123;</div><div class="line">	</div><div class="line"></div><div class="line">	</div><div class="line">	//执行sql语句需要sqliteDatabase对象</div><div class="line">	</div><div class="line">	//调用getReadableDatabase方法,来初始化数据库的创建</div><div class="line">	</div><div class="line">	SQLiteDatabase db = mySqliteOpenHelper.getReadableDatabase();</div><div class="line">	</div><div class="line">	</div><div class="line">	</div><div class="line">	//table:表名, columns：查询的列名,如果null代表查询所有列； selection:查询条件, selectionArgs：条件占位符的参数值,</div><div class="line">	</div><div class="line">	//groupBy:按什么字段分组, having:分组的条件, orderBy:按什么字段排序</div><div class="line">	</div><div class="line">	Cursor cursor = db.query(&quot;info&quot;, new String[]&#123;&quot;_id&quot;,&quot;name&quot;,&quot;phone&quot;&#125;, &quot;name = ?&quot;, new String[]&#123;name&#125;, null, null, &quot;_id desc&quot;);</div><div class="line">	</div><div class="line">	//解析Cursor中的数据</div><div class="line">	</div><div class="line">	if(cursor != null &amp;&amp; cursor.getCount() &gt;0)&#123;//判断cursor中是否存在数据</div><div class="line">	</div><div class="line">		</div><div class="line">	</div><div class="line">		//循环遍历结果集，获取每一行的内容</div><div class="line">	</div><div class="line">		while(cursor.moveToNext())&#123;//条件，游标能否定位到下一行</div><div class="line">	</div><div class="line">			//获取数据</div><div class="line">	</div><div class="line">			int id = cursor.getInt(0);</div><div class="line">	</div><div class="line">			String name_str = cursor.getString(1);</div><div class="line">	</div><div class="line">			String phone = cursor.getString(2);</div><div class="line">	</div><div class="line">			System.out.println(&quot;_id:&quot;+id+&quot;;name:&quot;+name_str+&quot;;phone:&quot;+phone);</div><div class="line">	</div><div class="line">		&#125;</div><div class="line">	</div><div class="line">		cursor.close();//关闭结果集</div><div class="line">	</div><div class="line">		</div><div class="line">	</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	//关闭数据库对象</div><div class="line">	</div><div class="line">	db.close();</div><div class="line"></div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="4-数据库的事务"><a href="#4-数据库的事务" class="headerlink" title="4 数据库的事务"></a>4 数据库的事务</h1><p>事务： 执行多条sql语句，要么同时执行成功，要么同时执行失败，不能有的成功，有的失败</p>
<p>银行转账</p>
<p>//点击按钮执行该方法</p>
<p>public void transtation(View v){</p>
<pre><code>//1.创建一个帮助类的对象

BankOpenHelper bankOpenHelper = new BankOpenHelper(this);

//2.调用数据库帮助类对象的getReadableDatabase创建数据库，初始化表数据，获取一个SqliteDatabase对象去做转账（sql语句）

SQLiteDatabase db = bankOpenHelper.getReadableDatabase();

//3.转账,将李四的钱减200，张三加200

db.beginTransaction();//开启一个数据库事务

try {

    db.execSQL(&quot;update account set money= money-200 where name=?&quot;,new String[]{&quot;李四&quot;});

    int i = 100/0;//模拟一个异常

    db.execSQL(&quot;update account set money= money+200 where name=?&quot;,new String[]{&quot;张三&quot;});




    db.setTransactionSuccessful();//标记事务中的sql语句全部成功执行

} finally {

    db.endTransaction();//判断事务的标记是否成功，如果不成功，回滚错误之前执行的sql语句 

}
</code></pre><p>}</p>
<p>#5 listview 入门</p>
<pre><code>ListView 是一个控件,一个在垂直滚动的列表中显示条目的一个控件，这些条目的内容来自于一个ListAdapter 。EditText Button TextView ImageView Checkbox 五大布局。







1.布局添加Listview



2.找到listview




3.创建一个Adapter适配器继承BaseAdapter，封装4个方法，其中getcount,getview必须封装

    getcount:告诉listview要显示的条目数

    getview：告诉listview每个条目显示的内容。

4.创建Adapter的一个对象，设置给listview。

        listview.setAdapter(ListAdapter adapter);
</code></pre><p>#6 listview优化 </p>
<p>adapter中getview方法会传进来一个convertView，convertView是指曾经使用过的view对象，可以被重复使用，但是在使用前需要判断是否为空，不为空直接复用，并作为getview方法的返回对象。</p>
<pre><code>TextView view = null;

if(convertView != null){//判断converView是否为空，不为空重新使用

    view = (TextView) convertView;

}else{

    view = new TextView(mContext);//创建一个textView对象

}

return view；
</code></pre><p>#7 listview—老虎机</p>
<p>javaweb mvc</p>
<p>m….mode….javabean</p>
<p>v….view….jsp</p>
<p>c….control…servlet</p>
<p>listview mvc</p>
<p>m….mode….Bean</p>
<p>v….view….listview</p>
<p>c….control…adapter</p>
<p>#8 listview显示原理 (了解)</p>
<p>1.要考虑listview显示的条目数    getcount</p>
<p>2.考虑listview每个条目显示的内容   getview</p>
<p>3.考虑每个item的高度，因为屏幕的多样化</p>
<p>4.还要考虑listview的滑动，监听一个旧的条目消失，一个新的条目显示。</p>
<p>#9 复杂listview界面显示 ,黑马新闻（<strong><strong><em>*</em></strong></strong>重要<strong><strong><em>*</em></strong></strong>）</p>
<p>1.布局写listview</p>
<p>2.找到listview</p>
<p>3.获取新闻数据封装到list集合中(才用模拟数据)，作为adapter的显示数据,怎么将获取的新闻数据给adapter???</p>
<p>4.创建一个adapter继承BaseAdapter，实现4个方法</p>
<pre><code>getcount: 有多少条新闻数据，就有多少个条目。

getView:将返回一个复杂的布局作为条目的内容展示；并且显示的数据是新闻的信息。 ？？？？？
</code></pre><p>public View getView(int position, View convertView, ViewGroup parent) {</p>
<pre><code>View view = null;

//1.复用converView优化listview,创建一个view作为getview的返回值用来显示一个条目

if(convertView != null){

    view = convertView;

}else {

    //context:上下文, resource:要转换成view对象的layout的id, root:将layout用root(ViewGroup)包一层作为getview的返回值,一般传null

    view = View.inflate(context, R.layout.item_news_layout, null);//将一个布局文件转换成一个view对象

}

//2.获取view上的子控件对象

ImageView item_img_icon = (ImageView) view.findViewById(R.id.item_img_icon);

TextView item_tv_des = (TextView) view.findViewById(R.id.item_tv_des);

TextView item_tv_title = (TextView) view.findViewById(R.id.item_tv_title);

//3.获取postion位置条目对应的list集合中的新闻数据，Bean对象

NewsBean newsBean = list.get(position);

//4.将数据设置给这些子控件做显示

item_img_icon.setImageDrawable(newsBean.icon);//设置imageView的图片

item_tv_title.setText(newsBean.title);

item_tv_des.setText(newsBean.des);



return view;
</code></pre><p>}</p>
<p>5.创建一个adapter对象设置给listview</p>
<p>6.设置listview的条目的点击事件，并封装点击事件,去查看新闻详情。 ?????????<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">	//设置listview条目的点击事件</div><div class="line">	</div><div class="line">	lv_news.setOnItemClickListener(this);</div><div class="line">	</div><div class="line"></div><div class="line">		//listview的条目点击时会调用该方法 parent:代表listviw  view:点击的条目上的那个view对象   position:条目的位置  id： 条目的id</div><div class="line"></div><div class="line">	</div><div class="line"></div><div class="line">public void onItemClick(AdapterView&lt;?&gt; parent, View view, int position,</div><div class="line">	</div><div class="line">		long id)&#123;</div><div class="line">	</div><div class="line">	</div><div class="line">	</div><div class="line">	//需要获取条目上bean对象中url做跳转</div><div class="line">	</div><div class="line">	NewsBean bean = (NewsBean) parent.getItemAtPosition(position);</div><div class="line">	</div><div class="line">	</div><div class="line">	</div><div class="line">	String url = bean.news_url;</div><div class="line">	</div><div class="line">	</div><div class="line">	</div><div class="line">	//跳转浏览器</div><div class="line">	</div><div class="line">	Intent intent = new Intent();</div><div class="line">	</div><div class="line">	intent.setAction(Intent.ACTION_VIEW);</div><div class="line">	</div><div class="line">	intent.setData(Uri.parse(url));</div><div class="line">	</div><div class="line">	startActivity(intent);</div><div class="line">	</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>1.布局写listview ok</p>
<p>2.找到listview ok </p>
<p>3.封装新闻数据到list集合中 ，目的是为adapter提供数据展示。 ok </p>
<p>4.封装一个Adapter类继承BaseAdatper，写一个构造方法接受list集合数据，复写四个方法</p>
<pre><code>a.创建一个构造方法  ok 

b.封装getCount方法   ok 

c.getView方法：   不ok

    1.复用convertview，模板代码,如果不都能空，需要将一个布局文件转换为view对象作为getview的返回对象。

        view = View.inflater(Context context, int resuorceId,ViewGroup root)

    2.找到view上的这些子控件，目的是将list集合中的bean数据一一对应设置给这些子控件




    3.从list集合中获取postion条目上要显示的数据Bean



    4.将获取的bean中的数据设置给这些子控件

d.getItem方法：将list集合中指定postion上的bean对象返回

e.getItemId,直接返回postion
</code></pre><p>5.创建一个封装的Adapter对象，设置给listview   ok</p>
<p>6.设置listview条目的点击事件  ok</p>
<pre><code>listview.setOnItem....
</code></pre><p>7.复写OnItemClicklistener方法，获取相应条目上的bean对象，最终获取到url，做Intent跳转;  不ok</p>
<p>#10 常用获取inflate的写法 </p>
<pre><code>1.

//context:上下文, resource:要转换成view对象的layout的id, root:将layout用root(ViewGroup)包一层作为codify的返回值,一般传null

    //view = View.inflate(context, R.layout.item_news_layout, null);//将一个布局文件转换成一个view对象




2.

//通过LayoutInflater将布局转换成view对象

//view =  LayoutInflater.from(context).inflate(R.layout.item_news_layout, null);



3.

//通过context获取系统服务得到一个LayoutInflater，通过LayoutInflater将一个布局转换为view对象

LayoutInflater layoutInflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);

view = layoutInflater.inflate(R.layout.item_news_layout, null);
</code></pre><p>#11 arrayadapter  (不用看，知道有这个玩意就行)</p>
<pre><code>//找到控件

ListView lv_array = (ListView) findViewById(R.id.lv_array);

ListView lv_simple = (ListView) findViewById(R.id.lv_simple);



//创建一个arrayAdapter
</code></pre><p>//context  , resource:布局id, textViewResourceId：条目布局中 textview控件的id, objects:条目上texitview显示的内容</p>
<pre><code>ArrayAdapter&lt;String&gt; arrayAdapter = new ArrayAdapter&lt;String&gt;(this, R.layout.item_listview_layout, R.id.item_tv_class, classz);

lv_array.setAdapter(arrayAdapter);
</code></pre><p>#12 simpleadapter   (不用看，知道有这个玩意就行)</p>
<pre><code>//创建一个simpleAdapter,封装simpleAdapter的数据

ArrayList&lt;Map&lt;String, String&gt;&gt; arrayList = new ArrayList&lt;Map&lt;String,String&gt;&gt;();

HashMap&lt;String, String&gt; hashMap = new HashMap&lt;String, String&gt;();

hashMap.put(&quot;class&quot;, &quot;C++&quot;);

arrayList.add(hashMap);



HashMap&lt;String, String&gt; hashMap1 = new HashMap&lt;String, String&gt;();

hashMap1.put(&quot;class&quot;, &quot;android&quot;);

arrayList.add(hashMap1);





HashMap&lt;String, String&gt; hashMap2 = new HashMap&lt;String, String&gt;();

hashMap2.put(&quot;class&quot;, &quot;javaEE&quot;);

arrayList.add(hashMap2);



//context, data:显示的数据, resource:item布局id, from: map中的key, to:布局中的控件id

SimpleAdapter simpleAdapter = new SimpleAdapter(this, arrayList, R.layout.item_listview_layout, new String[]{&quot;class&quot;}, new int[]{R.id.item_tv_class});



lv_simple.setAdapter(simpleAdapter);
</code></pre><p>#13 数据库的listview的界面显示 (新闻会了，这个就会了)</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/10/20/Android No.3/" data-id="ciw09dfmi0004joqejedetqv1" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2016/10/20/Android No.2/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/10/20/Android No.3/">(no title)</a>
          </li>
        
          <li>
            <a href="/2016/10/20/Android No.2/">(no title)</a>
          </li>
        
          <li>
            <a href="/2016/10/19/Android No 1/">(no title)</a>
          </li>
        
          <li>
            <a href="/2016/09/18/1.Two Sum/">(no title)</a>
          </li>
        
          <li>
            <a href="/2016/07/11/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 XJTUCJX<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>